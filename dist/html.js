var db = require("../models"), isAuthenticated = require("../config/middleware/isLoggedIn"); module.exports = function (a) { a.get("/", function (a, b) { return a.user ? b.redirect("/brewery") : void b.render("home", { className: "login" }) }), a.get("/login", function (a, b) { return a.user ? b.redirect("/brewery") : void b.render("login.pug", { className: "login" }) }), a.get("/signup", function (a, b) { b.render("signup", { className: "login" }) }), a.get("/brewery", function (a, b) { db.Brewery.findAll({ raw: !0 }).then(function (a) { b.render("brewery.pug", { breweries: a, className: "login" }) }) }), a.get("/beers", function (a, b) { db.Beer.findAll({ raw: !0 }).then(function (a) { b.render("beer.pug", { beers: a, className: "login" }) }) }), a.get("/brewery/add", isAuthenticated, function (a, b) { b.render("addBrewery", { className: "current" }) }), a.get("/beers/add", isAuthenticated, function (a, b) { b.render("addBeer", { className: "current" }) }), a.get("/users/:id", isAuthenticated, function (a, b) { db.User.findOne({ where: { id: a.params.id }, include: [db.Brewery] }).then(a => { console.log(a), b.render("userDetails", { User: a, className: "current" }) }) }), a.get("/beers/:id", isAuthenticated, function (a, b) { db.Beer.findOne({ where: { id: a.params.id }, include: [db.Brewery] }).then(a => { b.render("userDetails", { User: a, className: "current" }) }) }), a.get("/brewery/:id", isAuthenticated, function (a, b) { db.Beer.findAll({ where: { BreweryId: a.params.id } }).then(a => { console.log(a), b.render("addBeer", { beers: a, className: "current" }) }) }) };